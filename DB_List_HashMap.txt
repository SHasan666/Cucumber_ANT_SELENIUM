import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;


public class dbConnection {

	static Connection con;
	
	public static void main(String[] args) throws SQLException {
			//List<Object> li = new ArrayList<Object>();
		List<Map<String, String>> li = 	get();
		
		
		for(int i=0;i<li.size();i++)
		{
			System.out.println(li.get(i));
		}
	
	}
	
	
	public static List<Map<String, String>> get()
	{
		
	try{
			  
		
			
			
			//step1 load the driver class
			Class.forName("com.mysql.jdbc.Driver");

			//step2 create  the connection object
			 con=DriverManager.getConnection("jdbc:mysql://123.49.42.237:3306/test","test","test");

			 Statement stmt = con.createStatement();
			    ResultSet rs = stmt.executeQuery("Select * from student_sakib");
			    ResultSetMetaData rsmd = rs.getMetaData();
			    List<String> columns = new ArrayList<String>(rsmd.getColumnCount());
			    for(int i = 1; i <= rsmd.getColumnCount(); i++){
			        columns.add(rsmd.getColumnName(i));
			    }
			    List<Map<String,String>> data = new ArrayList<Map<String,String>>();
			    while(rs.next()){                
			        Map<String,String> row = new HashMap<String, String>(columns.size());
			        for(String col : columns) {
			        	//System.out.println("===================== "+col+" ------> "+rs.getString(col)+"==================");
			            row.put(col, rs.getString(col));
			        }
			        data.add(row);
			    }
			    //System.out.println(data);
			    
			    rs.close();
			    stmt.close();
			    con.close();
			    return data;
			} catch (Exception e) {
			    System.out.println(e);
			}
	return null;
		
	}
}